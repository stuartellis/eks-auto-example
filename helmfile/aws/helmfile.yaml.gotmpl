bases:
  - bases/defaults.yaml
  - bases/repositories.yaml
  - bases/environments.yaml

templates:
  values: &values
    values:
      - config/releases/{{ `{{ .Release.Name }}` }}/values.yaml.gotmpl

lockFilePath: helmfile.{{ .Environment.Name }}.lock

releases:
  - name: eks-nodes-standard
    chart: ../../helm/charts/private/eks-nodes-standard
    labels:
      app: eks-nodes-standard
    namespace: default
    installed: true
    <<: *values

  - name: canary
    chart: ../../helm/charts/private/canary
    labels:
      app: canary
    namespace: canary
    installed: false
    <<: *values

  - name: podinfo
    chart: podinfo/podinfo
    labels:
      app: podinfo
    namespace: podinfo
    version: ">5.0.0"
    installed: true
    needs:
     - default/eks-nodes-standard
    <<: *values

  - name: podinfo-ingress-alb
    chart: ../../helm/charts/private/eks-ingress-alb
    labels:
      app: podinfo
    namespace: podinfo
    installed: true
    needs:
     - podinfo/podinfo
    <<: *values
